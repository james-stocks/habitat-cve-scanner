# Habitat Core Plan CVE scanner

This Ruby script takes the latest `CVE-recent` CVE feed from http://nvd.nist.gov/vuln/data-feeds and the latest Habitat core plans from https://github.com/habitat-sh/core-plan and finds core plans that appear to be affected by a CVE.  
The `CVE-recent` CVE feed contains only recently published CVEs, but the script can be adapted to read in NIST's other JSON feeds e.g. read in the `CVE-2019` to check against all CVE's published this year.  

## TODO list
 * Do something with the results other than just `puts` them.
 * Review the [NIST schema](https://csrc.nist.gov/schema/nvd/feed/1.0/nvd_cve_feed_json_1.0.schema) and ensure the script logic doesn't ignore parts of the schema. 
 * Make the code support any of the NIST feeds (currently it's hardcoded to check the CVE-Recent feed).
 * Script is currently presumptuous that product name in CVE database and the core plan name match. It would be safer to create a map of CVE vendor/product names to core plan names; but this map would require maintenance.
 * core-plans may contain plans for multiple major versions of a software product - see intended process for this [here](https://github.com/habitat-sh/core-plans-rfcs/blob/master/_RFCs/0003-tracking-package-versions.md). This script should be updated to go and search all the major version plans and not just the current stable plan folder.
 * Differentiate the different severities of vulnerability. Currently the script just outputs any match.
 * Refactor the code to be more readable.
